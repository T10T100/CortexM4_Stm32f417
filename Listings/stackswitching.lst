


ARM Macro Assembler    Page 1 


    1 00000000                 PRESERVE8
    2 00000000                 EXPORT           SysTick_Handler
    3 00000000                 EXPORT           PendSV_Handler
    4 00000000                 EXPORT           SVC_Handler
    5 00000000                 EXPORT           EnableFPU
    6 00000000                 EXPORT           upcall                  [WEAK]
    7 00000000                 EXPORT           vmstart
    8 00000000                 EXPORT           vmaccessLvl
    9 00000000         
   10 00000000                 AREA             |.text|, CODE, READONLY
   11 00000000                 IMPORT           StackSwitchPSV
   12 00000000                 IMPORT           VMTick
   13 00000000                 IMPORT           VMSvc
   14 00000000                 IMPORT           VMInit
   15 00000000                 IMPORT           VMStart
   16 00000000         vmaccessLvl
                               FUNCTION
   17 00000000 F380 8814       MSR              CONTROL, R0
   18 00000004 4770            BX               LR
   19 00000006                 ENDP
   20 00000006         upcall  FUNCTION
   21 00000006 DF02            SWI              0x02
   22 00000008 4770            BX               LR
   23 0000000A                 ENDP
   24 0000000A         vmstart FUNCTION
   25 0000000A B672            CPSID            I
   26 0000000C         ;MSR     MSP, R1 
   27 0000000C F3BF 8F4F       DSB
   28 00000010 F7FF FFFE       BL               EnableFPU
   29 00000014 F7FF FFFE       BL               VMStart
   30 00000018 F3BF 8F5F       DMB
   31 0000001C F380 8809       MSR              PSP, R0
   32 00000020         ;MOV     R1, #6
   33 00000020 F381 8814       MSR              CONTROL, R1
   34 00000024 B662            CPSIE            I
   35 00000026 BD00            POP              {PC}
   36 00000028         
   37 00000028                 ENDP
   38 00000028         SysTick_Handler
                               FUNCTION
   39 00000028 B672            CPSID            I
   40 0000002A F3BF 8F4F       DSB
   41 0000002E F3EF 8009       MRS              R0, PSP
   42 00000032 E920 0FF0       STMDB            R0!, {R4-R11}
   43 00000036 B500            PUSH             {LR}
   44 00000038 F7FF FFFE       BL               VMTick
   45 0000003C F3BF 8F5F       DMB
   46 00000040 E8B0 0FF0       LDMIA            R0!, {R4-R11}
   47 00000044 F380 8809       MSR              PSP, R0
   48 00000048 F381 8814       MSR              CONTROL, R1
   49 0000004C B662            CPSIE            I
   50 0000004E BD00            POP              {PC}
   51 00000050                 ENDP
   52 00000050         PendSV_Handler
                               FUNCTION
   53 00000050         
   54 00000050                 ENDP
   55 00000050         SVC_Handler
                               FUNCTION



ARM Macro Assembler    Page 2 


   56 00000050 B672            CPSID            I
   57 00000052 F3BF 8F4F       DSB
   58 00000056 B500            PUSH             {LR}
   59 00000058 F3EF 8309       MRS              R3, PSP
   60 0000005C E923 0FF0       STMDB            R3!, {R4-R11}
   61 00000060 F7FF FFFE       BL               VMSvc
   62 00000064 E8B0 0FF0       LDMIA            R0!, {R4-R11}
   63 00000068 F380 8809       MSR              PSP, R0
   64 0000006C F381 8814       MSR              CONTROL, R1
   65 00000070 B662            CPSIE            I
   66 00000072 BD00            POP              {PC}
   67 00000074                 ENDP
   68 00000074         TableEnd
   69 00000074         
   70 00000074         EnableFPU
                               FUNCTION
   71 00000074         ; CPACR is located at address 0xE000ED88
   72 00000074 4804            LDR              R0, =0xE000ED88
   73 00000076         ; Read CPACR
   74 00000076 6801            LDR              R1, [R0]
   75 00000078         ; Set bits 20-23 to enable CP10 and CP11 coprocessors
   76 00000078 F441 0170       ORR              R1, R1, #(0xF << 20)
   77 0000007C         ; Write back the modified value to the CPACR
   78 0000007C 6001            STR              R1, [R0]    ; wait for store to
                                                             complete
   79 0000007E F3BF 8F4F       DSB
   80 00000082         ;reset pipeline now the FPU is enabled
   81 00000082 F3BF 8F6F       ISB
   82 00000086 4770            BX               LR
   83 00000088                 ENDP
   84 00000088                 END
              E000ED88 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp --apcs=int
erwork --depend=.\objects\stackswitching.d -o.\objects\stackswitching.o -I.\mis
c\inc -I..\platform -IE:\KeilProj\platform\RTE -IC:\Keil_v5\ARM\PACK\ARM\CMSIS\
4.3.0\CMSIS\Include -IC:\Keil_v5\ARM\PACK\Keil\STM32F4xx_DFP\2.4.0 --predefine=
"__UVISION_VERSION SETA 514" --predefine="_RTE_ SETA 1" --predefine="STM32F417x
x SETA 1" --predefine="stackSwitching SETA 1" --list=.\listings\stackswitching.
lst misc\depend\Arm\CortexM4\src\stackSwitching.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 10 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      None
Comment: .text unused
EnableFPU 00000074

Symbol: EnableFPU
   Definitions
      At line 70 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 5 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
      At line 28 in file misc\depend\Arm\CortexM4\src\stackSwitching.s

PendSV_Handler 00000050

Symbol: PendSV_Handler
   Definitions
      At line 52 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 3 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: PendSV_Handler used once
SVC_Handler 00000050

Symbol: SVC_Handler
   Definitions
      At line 55 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 4 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: SVC_Handler used once
SysTick_Handler 00000028

Symbol: SysTick_Handler
   Definitions
      At line 38 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 2 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: SysTick_Handler used once
TableEnd 00000074

Symbol: TableEnd
   Definitions
      At line 68 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      None
Comment: TableEnd unused
upcall 00000006

Symbol: upcall
   Definitions
      At line 20 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 6 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: upcall used once
vmaccessLvl 00000000




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: vmaccessLvl
   Definitions
      At line 16 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 8 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: vmaccessLvl used once
vmstart 0000000A

Symbol: vmstart
   Definitions
      At line 24 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 7 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: vmstart used once
9 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

StackSwitchPSV 00000000

Symbol: StackSwitchPSV
   Definitions
      At line 11 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      None
Comment: StackSwitchPSV unused
VMInit 00000000

Symbol: VMInit
   Definitions
      At line 14 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      None
Comment: VMInit unused
VMStart 00000000

Symbol: VMStart
   Definitions
      At line 15 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 29 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: VMStart used once
VMSvc 00000000

Symbol: VMSvc
   Definitions
      At line 13 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 61 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: VMSvc used once
VMTick 00000000

Symbol: VMTick
   Definitions
      At line 12 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
   Uses
      At line 44 in file misc\depend\Arm\CortexM4\src\stackSwitching.s
Comment: VMTick used once
5 symbols
351 symbols in table
